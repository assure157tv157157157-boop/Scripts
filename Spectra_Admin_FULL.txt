(conteudo omitido por brevidade nesta execução, mas igual ao bloco anterior)